---
создал заметку: 2024-08-18
---
Да, вы почти правильно поняли, но давайте уточним различия между методами `buffer.clear()` и `buffer.compact()`.

### `buffer.clear()`

- **Что делает:** 
  - Сбрасывает позицию (`position`) на 0 и устанавливает `limit` на максимальную ёмкость буфера.
  - Это означает, что буфер готов к полной перезаписи, и все данные, которые были записаны ранее, "затираются" с точки зрения текущих операций записи. Физически данные могут оставаться в памяти, но с точки зрения программы, буфер готов к заполнению новыми данными с самого начала.

- **Когда использовать:** 
  - Когда вам нужно полностью очистить буфер и начать запись с нуля.

- **Пример:**
  ```java
  buffer.clear();
  // Буфер готов к записи новых данных с начала
  ```

### `buffer.compact()`

- **Что делает:** 
  - Копирует все непрочитанные данные (текущие данные от позиции `position` до `limit`) в начало буфера.
  - Устанавливает `position` сразу после последнего байта скопированных данных, а `limit` — на максимальную ёмкость буфера.
  - Это позволяет записывать новые данные сразу после оставшихся данных, которые еще не были прочитаны.

- **Когда использовать:** 
  - Когда вы хотите сохранить непрочитанные данные и добавить новые данные сразу после них.

- **Пример:**
  ```java
  buffer.compact();
  // Буфер готов к записи новых данных сразу после непрочитанных данных
  ```

### Отличие на примере

Предположим, что у вас есть буфер с ёмкостью 10 байт, и он выглядит так после чтения нескольких байтов:

```
[1, 2, 3, 4, 5, x, x, x, x, x]
 position = 5, limit = 10
```

- Если вы вызовете `clear()`:
  - Буфер будет сброшен, и позиция будет установлена на 0, а `limit` — на 10:
    ```
    [1, 2, 3, 4, 5, x, x, x, x, x]
     position = 0, limit = 10
    ```
  - Любая последующая запись затрёт все существующие данные, начиная с первой позиции.

- Если вы вызовете `compact()`:
  - Непрочитанные байты (от `position` до `limit`) будут перемещены в начало буфера:
    ```
    [1, 2, 3, 4, 5, x, x, x, x, x]
     position = 0, limit = 10 (начальное состояние)

    // После compact()
    [5, x, x, x, x, x, x, x, x, x]
     position = 1, limit = 10
    ```
  - Теперь вы можете записывать новые данные начиная с позиции 1, сохраняя непрочитанные данные.

### Вывод

- **`clear()`**: Полностью готовит буфер для новой записи, затирая старые данные.
- **`compact()`**: Сохраняет непрочитанные данные и перемещает их в начало буфера, чтобы можно было дописать новые данные сразу после них.

Таким образом, вы правильно уловили идею, но важно помнить, что `compact()` не просто сохраняет старые данные, а именно перемещает непрочитанные данные в начало, а запись новых данных продолжается сразу после этих непрочитанных данных.