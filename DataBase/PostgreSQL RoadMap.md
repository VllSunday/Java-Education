---
создал заметку: 2024-08-19
---

# Дорожная карта PostgreSQL DBA

## Изучение базовых терминов и концепций СУБД
Получите базовое понимание ключевых терминов PostgreSQL и основных концепций реляционных СУБД.
- **Объектная модель:** типы данных, столбцы, строки, таблицы, схемы, базы данных, запросы.
- **Реляционная модель:** домены, атрибуты, кортежи, отношения, ограничения, NULL.
- **Высокоуровневые концепции баз данных:** ACID, MVCC, транзакции, журнал предзаписи (WAL), обработка запросов.
- **Ссылки:**
  - [Глоссарий PostgreSQL](https://www.postgresql.org/docs/13/glossary.html)
  - "SQL и реляционная теория" - Кристофер Дж. Дейт, 2009
  - "Проектирование баз данных и реляционная теория" - Кристофер Дж. Дейт, 2012

## Изучение установки и запуска PostgreSQL
Получите практические навыки настройки и запуска PostgreSQL для создания рабочей среды.
- Использование менеджеров пакетов (APT, YUM и т.д.).
- Использование `Docker`.
- Управление сервисом PostgreSQL с помощью `systemd` (запуск, остановка, перезапуск, перезагрузка).
- Управление сервисом PostgreSQL с помощью `pg_ctl` или инструментов, специфичных для ОС (например, `pg_ctlcluster`).
- Подключение к PostgreSQL с использованием `psql`.
- Развертывание сервиса баз данных в облачной среде (AWS, GCE, Azure, Heroku, DigitalOcean и др.).
- **Ссылки:**
  - [Официальные инструкции по скачиванию и установке](https://www.postgresql.org/download/)
  - [Официальные Docker-образы](https://hub.docker.com/_/postgres)

## Изучение SQL-концепций
Получите практические навыки создания и управления объектами базы данных, а также выполнения запросов с использованием клиента `psql`.
- Понимание базовых типов данных.
- DML-запросы: выборка данных, модификация данных, фильтрация данных, объединение таблиц.
  - **Продвинутые темы:** транзакции, CTE, подзапросы, lateral join, группировка, операции над множествами.
- DDL-запросы: управление таблицами и схемами (создание, изменение, удаление).
- Импорт и экспорт данных с использованием `COPY`.
- **Ссылки:**
  - [DB Fiddle](https://www.db-fiddle.com/)
  - [Учебник PostgreSQL](https://www.postgresqltutorial.com/)
  - [Начало работы с SQL в PostgreSQL](https://www.postgresql.org/docs/current/tutorial-sql.html)
  - [Язык SQL в PostgreSQL](https://www.postgresql.org/docs/current/sql.html)

## Изучение настройки PostgreSQL
Получите понимание основных аспектов конфигурации PostgreSQL. Глубокое понимание внутренней структуры PostgreSQL здесь пока не требуется.
- **postgresql.conf:**
  - Использование ресурсов
  - Журнал предзаписи (WAL)
  - Контрольные точки и фоновая запись
  - Вакуум на основе стоимости и автовауум
  - Репликация
  - Планировщик запросов
  - Отчеты, логирование и статистика
  - Добавление дополнительных расширений
  - ... продолжайте исследовать другие параметры конфигурации
- **Ссылки:**
  - [Postgresqlco.nf](http://postgresqlco.nf/)

## Изучение концепций безопасности PostgreSQL
Получите понимание основных концепций безопасности и распространенных способов развертывания безопасных конфигураций.
- Модели аутентификации, роли, pg_hba.conf, настройки SSL.
- Привилегии на объекты: предоставление/отзыв, привилегии по умолчанию.
- **Продвинутые темы:** безопасность на уровне строк, SELinux.
- **Ссылки:**
  - [Аутентификация клиентов](https://www.postgresql.org/docs/current/client-authentication.html)
  - [Управление ролями и пользователями](https://www.postgresql.org/docs/current/user-manag.html)

## Развитие навыков инфраструктурного DBA
Получите практические навыки развертывания, расширения, поддержки и обслуживания установок PostgreSQL и программного обеспечения экосистемы PostgreSQL.
- Репликация: потоковая репликация, логическая репликация.
- Инструменты для резервного копирования и восстановления:
  - Встроенные: `pg_dump`, `pg_dumpall`, `pg_restore`, `pg_basebackup`.
  - Сторонние: `barman`, `pgbackrest`, `pg_probackup`, `WAL-G`.
  - Процедуры проверки резервного копирования.
- Процедуры обновления:
  - Минорные и мажорные обновления с использованием `pg_upgrade`.
  - Обновления с использованием логической репликации.
- Пул соединений:
  - `Pgbouncer`.
  - Альтернативы: `Pgpool-II`, `Odyssey`, `Pgagroal`.
- Мониторинг инфраструктуры: `Prometheus`, `Zabbix`, другие популярные решения для мониторинга.
- Инструменты высокой доступности и управления кластерами:
  - `Patroni`.
  - Альтернативы: `Repmgr`, `Stolon`, `pg_auto_failover`, `PAF`.
- Балансировка нагрузки и обнаружение сервисов: `Haproxy`, `Keepalived`, `Consul`, `Etcd`.
- Развертывание PostgreSQL на `Kubernetes`: простая настройка `StatefulSet`, `HELM`, операторы.
- Использование ресурсов и планирование емкости.

## Изучение автоматизации рутинных задач
Получите практические навыки, изучите инструменты автоматизации и автоматизируйте существующие рутинные задачи.
- Автоматизация с использованием shell-скриптов или любого другого любимого языка (`Bash`, `Python`, `Perl` и т.д.).
- Управление конфигурацией: `Ansible`, `Salt`, `Chef`, `Puppet`.

## Развитие навыков DBA приложений
Изучите теорию и получите практические навыки, как приложения должны работать с PostgreSQL.
- Миграции:
  - Практические шаблоны и антишаблоны.
  - Инструменты: `liquibase`, `sqitch`, инструменты, специфичные для языков программирования.
- Импорт/экспорт данных, загрузка и обработка больших объемов данных.
- Очереди:
  - Практические шаблоны и антишаблоны.
  - `Skytools PGQ`.
- Паттерны и шаблоны разбиения данных и шардирования.
- Нормализация базы данных и нормальные формы.
- **Книги:**
  - "Искусство PostgreSQL" - Димитрий Фонтейн, 2020.

## Изучение продвинутых тем PostgreSQL
Здесь важно непрерывно развивать и расширять существующие знания о PostgreSQL.
- **Низкоуровневая внутренняя структура:**
  - Процессы и архитектура памяти.
  - Обработка вакуума.
  - Управление буферами.
  - Управление блокировками.
  - [Физическое хранение и файловая структура](https://www.postgresql.org/docs/current/storage.html)
  - [Системный каталог](https://www.postgresql.org/docs/current/catalogs.html)
- **Тонкая настройка:**
  - Настройки на уровне пользователя, на уровне базы данных.
  - [Параметры хранения](https://www.postgresql.org/docs/current/sql-createtable.html#SQL-CREATETABLE-STORAGE-PARAMETERS)
  - Настройка в зависимости от рабочей нагрузки: OLTP, OLAP, HTAP.
- **Продвинутые темы SQL:**
  - PL/pgSQL, процедуры и функции, триггеры.
  - Агрегатные и оконные функции.
  - Рекурсивные CTE.
- **Ссылки:**
  - [Внутренности PostgreSQL](http://www.interdb.jp/pg/index.html) для администраторов баз данных и системных разработчиков.
  - [Руководство по PL/pgSQL](https://www.postgresql.org/docs/current/plpgsql.html).

## Изучение методов устранения неполадок PostgreSQL
Получите базовые знания о средствах устранения неполадок и практические навыки обнаружения и решения проблем.
- **Инструменты операционной системы:**
  - `top` (`htop`, `atop`).
  - `sysstat`.
  - `iotop`.
- **Системные представления PostgreSQL:**
  - `pg_stat_activity`.
  - `pg_stat_statements`.
- **Инструменты PostgreSQL:**
  - `pgcenter` - *личная рекомендация*.
- **Анализ запрос

ов:**
  - Изучите и используйте `EXPLAIN`, `EXPLAIN ANALYZE`.
  - Научитесь читать планы выполнения запросов.
  - [Создание индексов](https://www.postgresql.org/docs/current/indexes.html).
  - Поддержка индексов.
  - Разработка и развертывание правильных стратегий индексации.
- **Ссылки:**
  - [Официальная документация по индексам](https://www.postgresql.org/docs/current/indexes.html)
  - [Понимание планов выполнения запросов](https://explain.depesz.com/)
